<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Test IQ - ƒê√°nh Gi√° NƒÉng L·ª±c Nh·∫≠n Th·ª©c</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e40af;
            --primary-dark: #1e3a8a;
            --primary-light: #3b82f6;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            --card-bg: rgba(30, 41, 59, 0.8);
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --border: rgba(148, 163, 184, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(245, 158, 11, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container { max-width: 900px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }

        .header { text-align: center; padding: 40px 20px; margin-bottom: 30px; }

        .logo { display: inline-flex; align-items: center; gap: 12px; margin-bottom: 20px; }

        .logo-icon {
            width: 56px; height: 56px;
            background: linear-gradient(135deg, var(--primary-light), var(--accent));
            border-radius: 16px;
            display: flex; align-items: center; justify-content: center;
            font-size: 28px;
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.3);
        }

        .logo-text {
            font-size: 28px; font-weight: 800;
            background: linear-gradient(135deg, #fff, var(--primary-light));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }

        .progress-container {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
        }

        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .progress-info { display: flex; gap: 24px; }
        .progress-item { display: flex; align-items: center; gap: 8px; }

        .progress-item-icon {
            width: 36px; height: 36px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 18px;
        }

        .progress-item-label { font-size: 12px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        .progress-item-value { font-family: 'JetBrains Mono', monospace; font-size: 18px; font-weight: 600; color: var(--text); }

        .timer-warning { color: var(--danger); animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .progress-bar-track { height: 8px; background: rgba(148, 163, 184, 0.2); border-radius: 4px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary-light), var(--accent)); border-radius: 4px; transition: width 0.5s ease; }

        .question-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid var(--border);
            margin-bottom: 24px;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .question-badge {
            display: inline-flex; align-items: center; gap: 8px;
            padding: 6px 14px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 20px;
            font-size: 13px; font-weight: 600;
            color: var(--primary-light);
            margin-bottom: 20px;
        }

        .question-text { font-size: 20px; font-weight: 600; margin-bottom: 28px; line-height: 1.5; }

        .matrix-container { display: flex; justify-content: center; margin-bottom: 32px; }

        .matrix {
            display: grid; gap: 8px; padding: 20px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 16px;
            border: 2px solid var(--border);
        }

        .matrix-3x3 { grid-template-columns: repeat(3, 80px); grid-template-rows: repeat(3, 80px); }

        .matrix-cell {
            background: rgba(241, 245, 249, 0.95);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 32px; font-weight: 700;
            color: #1e293b;
        }

        .matrix-cell.question-mark {
            background: linear-gradient(135deg, var(--accent), #fbbf24);
            color: #fff;
            font-size: 36px;
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
        }

        .options-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
        @media (max-width: 600px) { .options-grid { grid-template-columns: 1fr; } }

        .option-btn {
            background: rgba(30, 41, 59, 0.6);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex; align-items: center; gap: 16px;
            text-align: left;
        }

        .option-btn:hover { background: rgba(59, 130, 246, 0.15); border-color: var(--primary-light); transform: translateY(-2px); }
        .option-btn.selected { background: rgba(59, 130, 246, 0.25); border-color: var(--primary-light); box-shadow: 0 0 20px rgba(59, 130, 246, 0.2); }

        .option-letter {
            width: 44px; height: 44px;
            background: rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 18px;
            color: var(--text-muted);
            flex-shrink: 0;
        }

        .option-btn.selected .option-letter { background: var(--primary-light); color: #fff; }
        .option-content { flex: 1; font-size: 16px; color: var(--text); font-weight: 500; }

        .option-visual {
            width: 60px; height: 60px;
            background: rgba(241, 245, 249, 0.95);
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 28px; font-weight: 700;
            color: #1e293b;
        }

        .nav-buttons { display: flex; justify-content: space-between; gap: 16px; }

        .btn {
            padding: 16px 32px;
            border-radius: 14px;
            font-size: 16px; font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex; align-items: center; gap: 10px;
        }

        .btn-secondary { background: rgba(148, 163, 184, 0.2); color: var(--text); }
        .btn-secondary:hover { background: rgba(148, 163, 184, 0.3); }

        .btn-primary { background: linear-gradient(135deg, var(--primary-light), var(--primary)); color: #fff; box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 30px rgba(59, 130, 246, 0.4); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .start-screen { text-align: center; padding: 60px 20px; }
        .start-screen h1 { font-size: 42px; font-weight: 800; margin-bottom: 16px; background: linear-gradient(135deg, #fff, var(--primary-light)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .start-screen p { color: var(--text-muted); font-size: 18px; max-width: 600px; margin: 0 auto 40px; }

        .info-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }

        .info-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid var(--border);
        }

        .info-card-icon { width: 56px; height: 56px; background: rgba(59, 130, 246, 0.2); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 28px; margin-bottom: 16px; }
        .info-card h3 { font-size: 18px; margin-bottom: 8px; }
        .info-card p { font-size: 14px; color: var(--text-muted); margin: 0; }

        .user-form { max-width: 400px; margin: 0 auto 32px; }
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-label { display: block; font-size: 14px; font-weight: 600; margin-bottom: 8px; color: var(--text); }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 16px;
            font-family: inherit;
        }

        .form-input:focus { outline: none; border-color: var(--primary-light); box-shadow: 0 0 20px rgba(59, 130, 246, 0.2); }
        .form-input::placeholder { color: var(--text-muted); }

        .btn-start { padding: 18px 48px; font-size: 18px; background: linear-gradient(135deg, var(--accent), #d97706); box-shadow: 0 8px 32px rgba(245, 158, 11, 0.3); }
        .btn-start:hover { box-shadow: 0 12px 40px rgba(245, 158, 11, 0.4); }

        .results-screen { text-align: center; padding: 40px 20px; }

        .results-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 32px;
            padding: 48px;
            border: 1px solid var(--border);
            margin-bottom: 32px;
        }

        .score-circle {
            width: 200px; height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin: 0 auto 32px;
            box-shadow: 0 20px 60px rgba(59, 130, 246, 0.4);
            position: relative;
        }

        .score-circle::before { content: ''; position: absolute; inset: 8px; border-radius: 50%; background: var(--card-bg); }
        .score-content { position: relative; z-index: 1; }
        .score-label { font-size: 14px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        .score-value { font-size: 56px; font-weight: 800; background: linear-gradient(135deg, var(--primary-light), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }

        .result-classification { font-size: 28px; font-weight: 700; margin-bottom: 12px; color: var(--accent); }
        .result-description { color: var(--text-muted); font-size: 16px; max-width: 500px; margin: 0 auto 32px; }

        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 32px; }
        .stat-item { background: rgba(15, 23, 42, 0.5); border-radius: 16px; padding: 24px; }
        .stat-value { font-size: 32px; font-weight: 700; color: var(--primary-light); margin-bottom: 4px; }
        .stat-label { font-size: 13px; color: var(--text-muted); }

        .breakdown-section { text-align: left; margin-top: 32px; padding-top: 32px; border-top: 1px solid var(--border); }
        .breakdown-title { font-size: 18px; font-weight: 700; margin-bottom: 20px; }
        .breakdown-item { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
        .breakdown-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0; }
        .breakdown-info { flex: 1; }
        .breakdown-name { font-weight: 600; margin-bottom: 4px; }
        .breakdown-bar { height: 8px; background: rgba(148, 163, 184, 0.2); border-radius: 4px; overflow: hidden; }
        .breakdown-fill { height: 100%; border-radius: 4px; transition: width 1s ease; }
        .breakdown-score { font-family: 'JetBrains Mono', monospace; font-size: 16px; font-weight: 600; min-width: 60px; text-align: right; }

        .save-status { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; background: rgba(16, 185, 129, 0.2); border-radius: 12px; color: var(--success); font-size: 14px; margin-bottom: 24px; }
        .save-status.error { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .save-status.pending { background: rgba(245, 158, 11, 0.2); color: var(--accent); }

        .hidden { display: none !important; }
        .spinner { width: 20px; height: 20px; border: 2px solid transparent; border-top-color: currentColor; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 600px) {
            .header { padding: 24px 16px; }
            .question-card { padding: 24px; }
            .matrix-3x3 { grid-template-columns: repeat(3, 60px); grid-template-rows: repeat(3, 60px); }
            .matrix-cell { font-size: 24px; }
            .start-screen h1 { font-size: 32px; }
            .score-circle { width: 160px; height: 160px; }
            .score-value { font-size: 44px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div id="startScreen" class="start-screen">
            <div class="logo">
                <div class="logo-icon">üß†</div>
                <span class="logo-text">IQ Assessment</span>
            </div>
            
            <h1>B√†i Ki·ªÉm Tra NƒÉng L·ª±c Nh·∫≠n Th·ª©c</h1>
            <p>B√†i test ƒë∆∞·ª£c thi·∫øt k·∫ø d·ª±a tr√™n m√¥ h√¨nh Raven's Progressive Matrices v√† c√°c chu·∫©n ƒëo l∆∞·ªùng IQ qu·ªëc t·∫ø, ƒë√°nh gi√° kh·∫£ nƒÉng t∆∞ duy logic, nh·∫≠n d·∫°ng pattern v√† gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ.</p>
            
            <div class="info-cards">
                <div class="info-card">
                    <div class="info-card-icon">üìù</div>
                    <h3>30 C√¢u H·ªèi</h3>
                    <p>4 d·∫°ng b√†i: Pattern, S·ªë h·ªçc, Kh√¥ng gian, Ng√¥n ng·ªØ</p>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">‚è±Ô∏è</div>
                    <h3>25 Ph√∫t</h3>
                    <p>Th·ªùi gian gi·ªõi h·∫°n ƒë·ªÉ ho√†n th√†nh to√†n b·ªô b√†i test</p>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">üé≤</div>
                    <h3>5 B·ªô ƒê·ªÅ</h3>
                    <p>Random b·ªô ƒë·ªÅ m·ªói l·∫ßn l√†m, ƒë·∫£m b·∫£o c√¥ng b·∫±ng</p>
                </div>
            </div>

            <div class="user-form">
                <div class="form-group">
                    <label class="form-label">H·ªç v√† t√™n *</label>
                    <input type="text" id="userName" class="form-input" placeholder="Nh·∫≠p h·ªç t√™n ƒë·∫ßy ƒë·ªß" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email c√¥ng ty *</label>
                    <input type="email" id="userEmail" class="form-input" placeholder="email@company.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ph√≤ng ban</label>
                    <select id="department" class="form-input">
                        <option value="">-- Ch·ªçn ph√≤ng ban --</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Sales (Kinh doanh)</option>
                        <option value="Production">Production (S·∫£n xu·∫•t)</option>
                        <option value="Purchasing">Purchasing (Mua h√†ng)</option>
                        <option value="Accounting">Accounting (K·∫ø to√°n)</option>
                        <option value="Operations">Operations (V·∫≠n h√†nh)</option>
                        <option value="HR">HR (Nh√¢n s·ª±)</option>
                        <option value="Assistant">Assistant (Tr·ª£ l√Ω)</option>
                        <option value="Other">Kh√°c</option>
                    </select>
                </div>
            </div>

            <button class="btn btn-primary btn-start" onclick="startTest()">
                B·∫Øt ƒê·∫ßu L√†m B√†i
                <span>‚Üí</span>
            </button>
        </div>

        <!-- Test Screen -->
        <div id="testScreen" class="hidden">
            <div class="header">
                <div class="logo">
                    <div class="logo-icon">üß†</div>
                    <span class="logo-text">IQ Assessment</span>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-info">
                        <div class="progress-item">
                            <div class="progress-item-icon">üìù</div>
                            <div>
                                <div class="progress-item-label">C√¢u h·ªèi</div>
                                <div class="progress-item-value"><span id="currentQ">1</span>/30</div>
                            </div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-item-icon">‚è±Ô∏è</div>
                            <div>
                                <div class="progress-item-label">Th·ªùi gian</div>
                                <div class="progress-item-value" id="timer">25:00</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="progress-bar-track">
                    <div class="progress-bar-fill" id="progressBar" style="width: 3.33%"></div>
                </div>
            </div>

            <div class="question-card">
                <div class="question-badge" id="categoryBadge">
                    <span>üî∑</span>
                    <span id="categoryName">Pattern Recognition</span>
                </div>
                
                <div class="question-text" id="questionText"></div>
                <div id="visualArea" class="matrix-container"></div>
                <div class="options-grid" id="optionsArea"></div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevQuestion()" disabled>
                    <span>‚Üê</span> C√¢u tr∆∞·ªõc
                </button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">
                    C√¢u ti·∫øp <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" class="hidden">
            <div class="results-screen">
                <div class="logo">
                    <div class="logo-icon">üß†</div>
                    <span class="logo-text">IQ Assessment</span>
                </div>

                <div class="results-card">
                    <div id="saveStatus" class="save-status pending">
                        <div class="spinner"></div>
                        <span>ƒêang l∆∞u k·∫øt qu·∫£...</span>
                    </div>

                    <div class="score-circle">
                        <div class="score-content">
                            <div class="score-label">ƒêi·ªÉm IQ</div>
                            <div class="score-value" id="iqScore">--</div>
                        </div>
                    </div>

                    <div class="result-classification" id="classification">--</div>
                    <div class="result-description" id="resultDesc">--</div>

                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="correctCount">--</div>
                            <div class="stat-label">C√¢u ƒë√∫ng / 30</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="percentile">--</div>
                            <div class="stat-label">Percentile</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="timeTaken">--</div>
                            <div class="stat-label">Th·ªùi gian l√†m b√†i</div>
                        </div>
                    </div>

                    <div class="breakdown-section">
                        <h3 class="breakdown-title">Ph√¢n t√≠ch chi ti·∫øt theo danh m·ª•c</h3>
                        
                        <div class="breakdown-item">
                            <div class="breakdown-icon" style="background: rgba(59, 130, 246, 0.2)">üî∑</div>
                            <div class="breakdown-info">
                                <div class="breakdown-name">Pattern Recognition (Ma tr·∫≠n)</div>
                                <div class="breakdown-bar">
                                    <div class="breakdown-fill" id="patternBar" style="background: #3b82f6; width: 0%"></div>
                                </div>
                            </div>
                            <div class="breakdown-score" id="patternScore">--/10</div>
                        </div>

                        <div class="breakdown-item">
                            <div class="breakdown-icon" style="background: rgba(16, 185, 129, 0.2)">üî¢</div>
                            <div class="breakdown-info">
                                <div class="breakdown-name">Number Sequences (D√£y s·ªë)</div>
                                <div class="breakdown-bar">
                                    <div class="breakdown-fill" id="numberBar" style="background: #10b981; width: 0%"></div>
                                </div>
                            </div>
                            <div class="breakdown-score" id="numberScore">--/8</div>
                        </div>

                        <div class="breakdown-item">
                            <div class="breakdown-icon" style="background: rgba(168, 85, 247, 0.2)">üìê</div>
                            <div class="breakdown-info">
                                <div class="breakdown-name">Spatial Reasoning (Kh√¥ng gian)</div>
                                <div class="breakdown-bar">
                                    <div class="breakdown-fill" id="spatialBar" style="background: #a855f7; width: 0%"></div>
                                </div>
                            </div>
                            <div class="breakdown-score" id="spatialScore">--/7</div>
                        </div>

                        <div class="breakdown-item">
                            <div class="breakdown-icon" style="background: rgba(245, 158, 11, 0.2)">üí¨</div>
                            <div class="breakdown-info">
                                <div class="breakdown-name">Verbal Analogies (T∆∞∆°ng t·ª± t·ª´)</div>
                                <div class="breakdown-bar">
                                    <div class="breakdown-fill" id="verbalBar" style="background: #f59e0b; width: 0%"></div>
                                </div>
                            </div>
                            <div class="breakdown-score" id="verbalScore">--/5</div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="downloadResult()">üìÑ T·∫£i k·∫øt qu·∫£</button>
                    <button class="btn btn-primary" onclick="restartTest()">üîÑ L√†m l·∫°i b√†i test</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // C·∫§U H√åNH
        // ============================================
        const CONFIG = {
            GOOGLE_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbw5HCOzw-Yfu1IF-o8C04SC8pxTT6sTwmLb_UQJhcGh9v8SOLRYitV4E7CS9zciogo/exec'
        };

        // ============================================
        // 5 B·ªò ƒê·ªÄ TEST IQ
        // ============================================
        const questionSets = {
            // ================== B·ªò ƒê·ªÄ 1 ==================
            set1: [
                // PATTERN (10 c√¢u)
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m h√¨nh ph√π h·ª£p ƒë·ªÉ ƒëi·ªÅn v√†o √¥ "?" trong ma tr·∫≠n:', matrix: [['‚ñ≤', '‚ñ†', '‚óè'], ['‚ñ†', '‚óè', '‚ñ≤'], ['‚óè', '‚ñ≤', '?']], options: ['‚ñ†', '‚óè', '‚ñ≤', '‚óÜ'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m pattern v√† ƒëi·ªÅn v√†o √¥ tr·ªëng:', matrix: [['1', '2', '3'], ['4', '5', '6'], ['7', '8', '?']], options: ['9', '10', '6', '7'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh quy lu·∫≠t v√† t√¨m h√¨nh c√≤n thi·∫øu:', matrix: [['‚óê', '‚óë', '‚óè'], ['‚óë', '‚óè', '‚óê'], ['‚óè', '‚óê', '?']], options: ['‚óë', '‚óè', '‚óê', '‚óã'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë ph√π h·ª£p trong ma tr·∫≠n:', matrix: [['2', '4', '6'], ['3', '6', '9'], ['4', '8', '?']], options: ['10', '12', '14', '16'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh ma tr·∫≠n theo quy lu·∫≠t:', matrix: [['‚òÖ', '‚òÜ', '‚òÖ'], ['‚òÜ', '‚òÖ', '‚òÜ'], ['‚òÖ', '‚òÜ', '?']], options: ['‚òÖ', '‚òÜ', '‚ú¶', '‚úß'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m quy lu·∫≠t v√† ƒëi·ªÅn √¥ c√≤n thi·∫øu:', matrix: [['A', 'B', 'C'], ['D', 'E', 'F'], ['G', 'H', '?']], options: ['I', 'J', 'K', 'L'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh pattern trong ma tr·∫≠n:', matrix: [['‚óá', '‚óá', '‚óÜ'], ['‚óá', '‚óÜ', '‚óÜ'], ['‚óÜ', '‚óÜ', '?']], options: ['‚óá', '‚óÜ', '‚óã', '‚óè'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë theo quy lu·∫≠t Fibonacci:', matrix: [['1', '1', '2'], ['3', '5', '8'], ['13', '21', '?']], options: ['34', '29', '26', '32'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh ma tr·∫≠n m≈©i t√™n:', matrix: [['‚Üí', '‚Üì', '‚Üê'], ['‚Üë', '‚Üí', '‚Üì'], ['‚Üê', '‚Üë', '?']], options: ['‚Üí', '‚Üì', '‚Üê', '‚Üë'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m ph·∫ßn t·ª≠ c√≤n thi·∫øu:', matrix: [['‚óã', '‚óê', '‚óè'], ['‚óã', '‚óê', '‚óè'], ['‚óã', '‚óê', '?']], options: ['‚óã', '‚óê', '‚óè', '‚óë'], answer: 2 },
                // NUMBER (8 c√¢u)
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 2, 4, 8, 16, 32, ?', options: ['48', '64', '56', '40'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë n√†o ti·∫øp theo: 1, 4, 9, 16, 25, ?', options: ['30', '36', '49', '32'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh d√£y s·ªë: 3, 6, 11, 18, 27, ?', options: ['38', '36', '35', '40'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 2, 6, 12, 20, 30, ?', options: ['40', '42', '44', '46'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'D√£y s·ªë: 5, 10, 20, 40, 80, ? S·ªë ti·∫øp theo l√†:', options: ['100', '120', '160', '140'], answer: 2 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m quy lu·∫≠t: 1, 3, 7, 15, 31, ?', options: ['63', '47', '55', '61'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë c√≤n thi·∫øu: 100, 81, 64, 49, 36, ?', options: ['25', '16', '30', '20'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh d√£y s·ªë nguy√™n t·ªë: 2, 3, 5, 7, 11, 13, ?', options: ['15', '17', '19', '14'], answer: 1 },
                // SPATIAL (7 c√¢u)
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'N·∫øu g·∫≠p h√¨nh vu√¥ng theo ƒë∆∞·ªùng ch√©o, h√¨nh n√†o s·∫Ω ƒë∆∞·ª£c t·∫°o ra?', options: ['Tam gi√°c vu√¥ng', 'Tam gi√°c ƒë·ªÅu', 'H√¨nh b√¨nh h√†nh', 'H√¨nh thoi'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay h√¨nh ch·ªØ L 90¬∞ theo chi·ªÅu kim ƒë·ªìng h·ªì, ch√¢n L h∆∞·ªõng n√†o?', options: ['Sang ph·∫£i', 'L√™n tr√™n', 'Sang tr√°i', 'Xu·ªëng d∆∞·ªõi'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh l·∫≠p ph∆∞∆°ng c√≥ bao nhi√™u c·∫°nh?', options: ['6', '8', '12', '10'], answer: 2 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Khi nh√¨n t·ª´ tr√™n xu·ªëng, h√¨nh ch√≥p vu√¥ng c√≥ d·∫°ng:', options: ['H√¨nh vu√¥ng', 'H√¨nh tam gi√°c', 'H√¨nh tr√≤n', 'H√¨nh thoi'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'G·∫•p gi·∫•y h√¨nh ch·ªØ nh·∫≠t ƒë√¥i 3 l·∫ßn, m·ªü ra c√≥ bao nhi√™u √¥?', options: ['6 √¥', '8 √¥', '4 √¥', '12 √¥'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh n√†o c√≥ th·ªÉ g·∫•p th√†nh h√¨nh l·∫≠p ph∆∞∆°ng?', options: ['Ch·ªØ th·∫≠p (6 √¥ vu√¥ng)', 'H√¨nh ch·ªØ L (5 √¥ vu√¥ng)', 'H√†ng ngang (6 √¥ vu√¥ng)', 'H√¨nh ch·ªØ T (5 √¥ vu√¥ng)'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'L·∫≠t g∆∞∆°ng h√¨nh tam gi√°c h∆∞·ªõng l√™n, tam gi√°c s·∫Ω h∆∞·ªõng:', options: ['Xu·ªëng', 'Sang tr√°i', 'Sang ph·∫£i', 'V·∫´n h∆∞·ªõng l√™n'], answer: 3 },
                // VERBAL (5 c√¢u)
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'N√≥ng : L·∫°nh = S√°ng : ?', options: ['ƒê√™m', 'T·ªëi', 'M·ªù', 'Tr∆∞a'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Chim : T·ªï = Ng∆∞·ªùi : ?', options: ['ƒê·ªông v·∫≠t', 'Nh√†', 'C√¥ng vi·ªác', 'Th·ª©c ƒÉn'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'B√°c sƒ© : B·ªánh vi·ªán = Gi√°o vi√™n : ?', options: ['B·ªánh nh√¢n', 'Tr∆∞·ªùng h·ªçc', 'H·ªçc sinh', 'S√°ch v·ªü'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'M·∫Øt : Nh√¨n = Tai : ?', options: ['√Çm thanh', 'Nghe', 'Ti·∫øng ƒë·ªông', 'Nh·∫°c'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'NƒÉm : Th√°ng = Tu·∫ßn : ?', options: ['Gi·ªù', 'Ng√†y', 'Ph√∫t', 'Th·∫ø k·ª∑'], answer: 1 }
            ],

            // ================== B·ªò ƒê·ªÄ 2 ==================
            set2: [
                // PATTERN (10 c√¢u)
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m h√¨nh c√≤n thi·∫øu trong ma tr·∫≠n:', matrix: [['‚óè', '‚óè', '‚óã'], ['‚óè', '‚óã', '‚óã'], ['‚óã', '‚óã', '?']], options: ['‚óè', '‚óã', '‚óê', '‚óë'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn s·ªë v√†o √¥ tr·ªëng:', matrix: [['2', '4', '8'], ['16', '32', '64'], ['128', '256', '?']], options: ['512', '384', '320', '480'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh quy lu·∫≠t:', matrix: [['‚ô†', '‚ô•', '‚ô¶'], ['‚ô•', '‚ô¶', '‚ô£'], ['‚ô¶', '‚ô£', '?']], options: ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë theo quy lu·∫≠t nh√¢n:', matrix: [['1', '2', '4'], ['2', '4', '8'], ['3', '6', '?']], options: ['9', '12', '18', '10'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh ma tr·∫≠n ch·ªØ c√°i:', matrix: [['Z', 'Y', 'X'], ['W', 'V', 'U'], ['T', 'S', '?']], options: ['R', 'Q', 'P', 'O'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m h√¨nh theo quy lu·∫≠t xoay:', matrix: [['‚Üë', '‚Üí', '‚Üì'], ['‚Üí', '‚Üì', '‚Üê'], ['‚Üì', '‚Üê', '?']], options: ['‚Üë', '‚Üí', '‚Üì', '‚Üê'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn s·ªë v√†o ma tr·∫≠n:', matrix: [['5', '10', '15'], ['10', '15', '20'], ['15', '20', '?']], options: ['25', '30', '35', '22'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m ph·∫ßn t·ª≠ thi·∫øu:', matrix: [['‚ñ°', '‚ñ†', '‚ñ°'], ['‚ñ†', '‚ñ°', '‚ñ†'], ['‚ñ°', '‚ñ†', '?']], options: ['‚ñ°', '‚ñ†', '‚ñ£', '‚ñ¢'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh pattern s·ªë:', matrix: [['1', '3', '5'], ['7', '9', '11'], ['13', '15', '?']], options: ['17', '16', '18', '19'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh d√£y h√¨nh:', matrix: [['‚óÜ', '‚óá', '‚óÜ'], ['‚óá', '‚óÜ', '‚óá'], ['‚óÜ', '‚óá', '?']], options: ['‚óÜ', '‚óá', '‚óã', '‚óè'], answer: 0 },
                // NUMBER (8 c√¢u)
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 3, 6, 12, 24, 48, ?', options: ['72', '96', '84', '60'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë n√†o ti·∫øp theo: 1, 8, 27, 64, 125, ?', options: ['196', '216', '256', '180'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh d√£y: 2, 5, 10, 17, 26, ?', options: ['35', '37', '36', '38'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 1, 2, 4, 7, 11, ?', options: ['15', '16', '14', '17'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'D√£y s·ªë: 81, 27, 9, 3, ? S·ªë ti·∫øp theo l√†:', options: ['1', '0', '2', '-1'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m quy lu·∫≠t: 2, 6, 18, 54, ?', options: ['108', '162', '148', '172'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë c√≤n thi·∫øu: 144, 121, 100, 81, 64, ?', options: ['49', '36', '56', '42'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh: 0, 1, 1, 2, 3, 5, 8, ?', options: ['11', '13', '12', '10'], answer: 1 },
                // SPATIAL (7 c√¢u)
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh tr·ª• c√≥ bao nhi√™u m·∫∑t?', options: ['2', '3', '4', '1'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay h√¨nh vu√¥ng 45¬∞, n√≥ tr√¥ng gi·ªëng h√¨nh g√¨?', options: ['H√¨nh thoi', 'H√¨nh ch·ªØ nh·∫≠t', 'H√¨nh b√¨nh h√†nh', 'H√¨nh tam gi√°c'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh c·∫ßu c√≥ bao nhi√™u ƒë·ªânh?', options: ['1', '2', '0', 'V√¥ s·ªë'], answer: 2 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Khi c·∫Øt h√¨nh l·∫≠p ph∆∞∆°ng b·∫±ng m·∫∑t ph·∫≥ng ngang, m·∫∑t c·∫Øt c√≥ d·∫°ng:', options: ['H√¨nh vu√¥ng', 'H√¨nh tr√≤n', 'H√¨nh tam gi√°c', 'H√¨nh l·ª•c gi√°c'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'G·∫•p t·ªù gi·∫•y l√†m ƒë√¥i 4 l·∫ßn, m·ªü ra c√≥ bao nhi√™u n·∫øp?', options: ['8', '15', '16', '12'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh t·ª© di·ªán ƒë·ªÅu c√≥ bao nhi√™u m·∫∑t?', options: ['3', '4', '5', '6'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay h√¨nh ch·ªØ nh·∫≠t 180¬∞, k·∫øt qu·∫£ l√†:', options: ['Gi·ªëng h√¨nh ban ƒë·∫ßu', 'H√¨nh vu√¥ng', 'H√¨nh thoi', 'H√¨nh b√¨nh h√†nh'], answer: 0 },
                // VERBAL (5 c√¢u)
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'S√°ch : ƒê·ªçc = Nh·∫°c : ?', options: ['Vi·∫øt', 'Nghe', 'H√°t', 'Ch∆°i'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'C√° : N∆∞·ªõc = Chim : ?', options: ['Tr·ªùi', 'C√¢y', 'ƒê·∫•t', 'Kh√¥ng kh√≠'], answer: 0 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Th·ª£ m·ªôc : G·ªó = Th·ª£ may : ?', options: ['Kim', 'V·∫£i', 'Ch·ªâ', 'M√°y'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Tay : GƒÉng = ƒê·∫ßu : ?', options: ['T√≥c', 'N√≥n', 'M≈©', 'KhƒÉn'], answer: 2 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'S∆∞ t·ª≠ : R·ª´ng = C√° m·∫≠p : ?', options: ['S√¥ng', 'Bi·ªÉn', 'H·ªì', 'Ao'], answer: 1 }
            ],

            // ================== B·ªò ƒê·ªÄ 3 ==================
            set3: [
                // PATTERN (10 c√¢u)
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m h√¨nh ph√π h·ª£p:', matrix: [['‚ñº', '‚ñ≤', '‚ñº'], ['‚ñ≤', '‚ñº', '‚ñ≤'], ['‚ñº', '‚ñ≤', '?']], options: ['‚ñº', '‚ñ≤', '‚ñ∫', '‚óÑ'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn s·ªë v√†o ma tr·∫≠n:', matrix: [['3', '9', '27'], ['4', '16', '64'], ['5', '25', '?']], options: ['100', '125', '150', '75'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh quy lu·∫≠t m√†u:', matrix: [['üî¥', 'üü°', 'üîµ'], ['üü°', 'üîµ', 'üî¥'], ['üîµ', 'üî¥', '?']], options: ['üü°', 'üî¥', 'üîµ', 'üü¢'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m ch·ªØ c√≤n thi·∫øu:', matrix: [['B', 'D', 'F'], ['H', 'J', 'L'], ['N', 'P', '?']], options: ['Q', 'R', 'S', 'T'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh ma tr·∫≠n:', matrix: [['‚ô¶', '‚ô¶', '‚ô£'], ['‚ô¶', '‚ô£', '‚ô£'], ['‚ô£', '‚ô£', '?']], options: ['‚ô¶', '‚ô£', '‚ô†', '‚ô•'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë theo quy lu·∫≠t:', matrix: [['11', '22', '33'], ['44', '55', '66'], ['77', '88', '?']], options: ['99', '100', '89', '90'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn h√¨nh v√†o √¥ tr·ªëng:', matrix: [['‚òÄ', '‚òÅ', '‚òÄ'], ['‚òÅ', '‚òÄ', '‚òÅ'], ['‚òÄ', '‚òÅ', '?']], options: ['‚òÄ', '‚òÅ', '‚≠ê', 'üåô'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh pattern:', matrix: [['1', '4', '9'], ['16', '25', '36'], ['49', '64', '?']], options: ['72', '81', '100', '90'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m k√Ω t·ª± thi·∫øu:', matrix: [['@', '#', '$'], ['#', '$', '%'], ['$', '%', '?']], options: ['@', '&', '^', '*'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh d√£y:', matrix: [['X', 'O', 'X'], ['O', 'X', 'O'], ['X', 'O', '?']], options: ['X', 'O', '+', '-'], answer: 0 },
                // NUMBER (8 c√¢u)
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 1, 3, 6, 10, 15, ?', options: ['20', '21', '22', '25'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë n√†o ti·∫øp theo: 2, 3, 5, 8, 12, ?', options: ['15', '17', '16', '18'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh d√£y: 4, 9, 16, 25, 36, ?', options: ['49', '45', '64', '42'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 1000, 500, 250, 125, ?', options: ['62.5', '75', '100', '50'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'D√£y s·ªë: 7, 14, 28, 56, ? S·ªë ti·∫øp theo l√†:', options: ['84', '112', '98', '70'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m quy lu·∫≠t: 5, 11, 23, 47, ?', options: ['95', '94', '93', '96'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë c√≤n thi·∫øu: 1, 1, 2, 6, 24, ?', options: ['48', '120', '100', '72'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh: 19, 23, 29, 31, 37, ?', options: ['41', '43', '39', '47'], answer: 0 },
                // SPATIAL (7 c√¢u)
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh l·∫≠p ph∆∞∆°ng c√≥ bao nhi√™u ƒë·ªânh?', options: ['6', '8', '12', '4'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'L·∫≠t ng∆∞·ª£c h√¨nh ch·ªØ "b", ta ƒë∆∞·ª£c ch·ªØ g√¨?', options: ['d', 'p', 'q', 'b'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh n√≥n c√≥ bao nhi√™u m·∫∑t?', options: ['1', '2', '3', '0'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Khi nh√¨n t·ª´ b√™n c·∫°nh, h√¨nh tr·ª• c√≥ d·∫°ng:', options: ['H√¨nh ch·ªØ nh·∫≠t', 'H√¨nh tr√≤n', 'H√¨nh elip', 'H√¨nh vu√¥ng'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay h√¨nh tam gi√°c ƒë·ªÅu 120¬∞, k·∫øt qu·∫£ l√†:', options: ['Gi·ªëng h√¨nh ban ƒë·∫ßu', 'H√¨nh kh√°c', 'H√¨nh l·ªôn ng∆∞·ª£c', 'H√¨nh nghi√™ng'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh b√°t di·ªán ƒë·ªÅu c√≥ bao nhi√™u m·∫∑t?', options: ['6', '8', '10', '12'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'G·∫•p tam gi√°c l√†m ƒë√¥i theo chi·ªÅu cao, ƒë∆∞·ª£c h√¨nh:', options: ['Tam gi√°c nh·ªè h∆°n', 'H√¨nh thang', 'H√¨nh ch·ªØ nh·∫≠t', 'H√¨nh vu√¥ng'], answer: 0 },
                // VERBAL (5 c√¢u)
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'ƒê·∫ßu : M≈© = Ch√¢n : ?', options: ['V·ªõ', 'Gi√†y', 'Qu·∫ßn', 'D√©p'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'M√°y bay : Phi c√¥ng = T√†u : ?', options: ['Thuy·ªÅn tr∆∞·ªüng', 'L√°i xe', 'H√†nh kh√°ch', 'Ti·∫øp vi√™n'], answer: 0 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Tr√°i c√¢y : Vitamin = Th·ªãt : ?', options: ['Ch·∫•t b√©o', 'Protein', 'ƒê∆∞·ªùng', 'Tinh b·ªôt'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'S√°ng : T·ªëi = Ng·ªçt : ?', options: ['Chua', 'M·∫∑n', 'ƒê·∫Øng', 'Cay'], answer: 2 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'H·ªça sƒ© : Tranh = Nh√† vƒÉn : ?', options: ['B√∫t', 'Gi·∫•y', 'S√°ch', 'Ch·ªØ'], answer: 2 }
            ],

            // ================== B·ªò ƒê·ªÄ 4 ==================
            set4: [
                // PATTERN (10 c√¢u)
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë c√≤n thi·∫øu:', matrix: [['6', '12', '18'], ['24', '30', '36'], ['42', '48', '?']], options: ['54', '56', '52', '60'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn h√¨nh v√†o ma tr·∫≠n:', matrix: [['‚óÑ', '‚ñ≤', '‚ñ∫'], ['‚ñº', '‚óÑ', '‚ñ≤'], ['‚ñ∫', '‚ñº', '?']], options: ['‚óÑ', '‚ñ≤', '‚ñ∫', '‚ñº'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh quy lu·∫≠t:', matrix: [['üåë', 'üåì', 'üåï'], ['üåì', 'üåï', 'üåó'], ['üåï', 'üåó', '?']], options: ['üåë', 'üåì', 'üåï', 'üåó'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m ch·ªØ ti·∫øp theo:', matrix: [['A', 'C', 'E'], ['G', 'I', 'K'], ['M', 'O', '?']], options: ['P', 'Q', 'R', 'S'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh pattern:', matrix: [['2', '3', '5'], ['7', '11', '13'], ['17', '19', '?']], options: ['21', '23', '25', '27'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m h√¨nh thi·∫øu:', matrix: [['‚ñ°', '‚ñ≥', '‚óã'], ['‚ñ≥', '‚óã', '‚ñ°'], ['‚óã', '‚ñ°', '?']], options: ['‚ñ°', '‚ñ≥', '‚óã', '‚óá'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn s·ªë theo quy lu·∫≠t:', matrix: [['1', '8', '27'], ['64', '125', '216'], ['343', '512', '?']], options: ['625', '729', '1000', '648'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh pattern:', matrix: [['‚¨Ü', '‚¨á', '‚¨Ü'], ['‚¨á', '‚¨Ü', '‚¨á'], ['‚¨Ü', '‚¨á', '?']], options: ['‚¨Ü', '‚¨á', '‚¨Ö', '‚û°'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë c√≤n thi·∫øu:', matrix: [['10', '20', '40'], ['80', '160', '320'], ['640', '1280', '?']], options: ['2560', '2000', '1920', '2400'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh ma tr·∫≠n:', matrix: [['1', '2', '4'], ['7', '11', '16'], ['22', '29', '?']], options: ['36', '37', '38', '35'], answer: 1 },
                // NUMBER (8 c√¢u)
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 4, 8, 16, 32, 64, ?', options: ['96', '128', '100', '120'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë n√†o ti·∫øp theo: 5, 10, 17, 26, 37, ?', options: ['48', '50', '52', '46'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh d√£y: 1, 2, 6, 24, 120, ?', options: ['600', '720', '840', '480'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 243, 81, 27, 9, 3, ?', options: ['0', '1', '2', '-1'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'D√£y s·ªë: 6, 11, 21, 36, 56, ?', options: ['81', '76', '71', '86'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m quy lu·∫≠t: 3, 5, 9, 17, 33, ?', options: ['49', '65', '57', '61'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë c√≤n thi·∫øu: 169, 144, 121, 100, 81, ?', options: ['64', '49', '72', '56'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh: 8, 11, 15, 20, 26, ?', options: ['32', '33', '34', '31'], answer: 1 },
                // SPATIAL (7 c√¢u)
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh l·∫≠p ph∆∞∆°ng c√≥ bao nhi√™u m·∫∑t?', options: ['4', '6', '8', '12'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay ch·ªØ "N" 180¬∞, ta ƒë∆∞·ª£c ch·ªØ g√¨?', options: ['Z', 'N', 'M', 'W'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Kim t·ª± th√°p vu√¥ng c√≥ bao nhi√™u c·∫°nh?', options: ['6', '8', '10', '12'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Khi c·∫Øt h√¨nh tr·ª• theo chi·ªÅu d·ªçc, m·∫∑t c·∫Øt c√≥ d·∫°ng:', options: ['H√¨nh tr√≤n', 'H√¨nh ch·ªØ nh·∫≠t', 'H√¨nh elip', 'H√¨nh vu√¥ng'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh c·∫ßu khi c·∫Øt b·ªüi m·∫∑t ph·∫≥ng lu√¥n cho:', options: ['H√¨nh tr√≤n', 'H√¨nh elip', 'H√¨nh vu√¥ng', 'T√πy c√°ch c·∫Øt'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'G·∫•p h√¨nh vu√¥ng th√†nh tam gi√°c c·∫ßn m·∫•y l·∫ßn g·∫•p?', options: ['1', '2', '3', '4'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay h√¨nh ng≈© gi√°c ƒë·ªÅu 72¬∞, k·∫øt qu·∫£ l√†:', options: ['Gi·ªëng h√¨nh ban ƒë·∫ßu', 'H√¨nh kh√°c', 'H√¨nh l·ªôn ng∆∞·ª£c', 'H√¨nh nghi√™ng'], answer: 0 },
                // VERBAL (5 c√¢u)
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Xe h∆°i : XƒÉng = ƒêi·ªán tho·∫°i : ?', options: ['S√≥ng', 'Pin', 'Wifi', '·ª®ng d·ª•ng'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'G√† : Tr·ª©ng = Hoa : ?', options: ['L√°', 'Qu·∫£', 'H·∫°t', 'C√†nh'], answer: 2 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'S√¥ng : Bi·ªÉn = ƒê∆∞·ªùng : ?', options: ['Xe', 'Th√†nh ph·ªë', 'Nh√†', 'C√¢y'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'L·ª≠a : N√≥ng = ƒê√° : ?', options: ['N·∫∑ng', 'C·ª©ng', 'L·∫°nh', 'S·∫Øc'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'B·∫ßu tr·ªùi : M√°y bay = ƒê·∫°i d∆∞∆°ng : ?', options: ['C√°', 'T√†u', 'S√≥ng', 'ƒê·∫£o'], answer: 1 }
            ],

            // ================== B·ªò ƒê·ªÄ 5 ==================
            set5: [
                // PATTERN (10 c√¢u)
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë ph√π h·ª£p:', matrix: [['8', '16', '24'], ['32', '40', '48'], ['56', '64', '?']], options: ['70', '72', '74', '76'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn h√¨nh c√≤n thi·∫øu:', matrix: [['‚óè', '‚óã', '‚óè'], ['‚óã', '‚óè', '‚óã'], ['‚óè', '‚óã', '?']], options: ['‚óè', '‚óã', '‚óê', '‚óë'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh quy lu·∫≠t:', matrix: [['üçé', 'üçä', 'üçã'], ['üçä', 'üçã', 'üçá'], ['üçã', 'üçá', '?']], options: ['üçé', 'üçä', 'üçã', 'üçá'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m ch·ªØ c√≤n thi·∫øu:', matrix: [['C', 'F', 'I'], ['L', 'O', 'R'], ['U', 'X', '?']], options: ['Y', 'Z', 'A', 'B'], answer: 2 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh pattern:', matrix: [['1', '4', '7'], ['10', '13', '16'], ['19', '22', '?']], options: ['24', '25', '26', '27'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m h√¨nh thi·∫øu:', matrix: [['‚Üó', '‚Üò', '‚Üô'], ['‚Üò', '‚Üô', '‚Üñ'], ['‚Üô', '‚Üñ', '?']], options: ['‚Üó', '‚Üò', '‚Üô', '‚Üñ'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'ƒêi·ªÅn s·ªë theo quy lu·∫≠t:', matrix: [['5', '25', '125'], ['6', '36', '216'], ['7', '49', '?']], options: ['343', '294', '392', '441'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'X√°c ƒë·ªãnh pattern:', matrix: [['Œ±', 'Œ≤', 'Œ≥'], ['Œ≤', 'Œ≥', 'Œ¥'], ['Œ≥', 'Œ¥', '?']], options: ['Œ±', 'Œµ', 'Œ≤', 'Œ∂'], answer: 1 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'T√¨m s·ªë c√≤n thi·∫øu:', matrix: [['15', '30', '45'], ['60', '75', '90'], ['105', '120', '?']], options: ['135', '130', '140', '125'], answer: 0 },
                { category: 'pattern', categoryName: 'Pattern Recognition', categoryIcon: 'üî∑', question: 'Ho√†n th√†nh ma tr·∫≠n:', matrix: [['‚ô§', '‚ôß', '‚ô°'], ['‚ôß', '‚ô°', '‚ô¢'], ['‚ô°', '‚ô¢', '?']], options: ['‚ô§', '‚ôß', '‚ô°', '‚ô¢'], answer: 0 },
                // NUMBER (8 c√¢u)
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 1, 5, 13, 29, 61, ?', options: ['93', '125', '109', '117'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë n√†o ti·∫øp theo: 6, 13, 27, 55, 111, ?', options: ['223', '220', '225', '218'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh d√£y: 11, 13, 17, 25, 41, ?', options: ['57', '73', '65', '81'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m s·ªë ti·∫øp theo: 625, 125, 25, 5, ?', options: ['0', '1', '2', '-1'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'D√£y s·ªë: 2, 9, 28, 65, 126, ?', options: ['189', '217', '196', '225'], answer: 1 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'T√¨m quy lu·∫≠t: 7, 11, 19, 35, 67, ?', options: ['131', '99', '115', '123'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'S·ªë c√≤n thi·∫øu: 196, 169, 144, 121, 100, ?', options: ['81', '64', '90', '72'], answer: 0 },
                { category: 'number', categoryName: 'Number Sequences', categoryIcon: 'üî¢', question: 'Ho√†n th√†nh: 12, 15, 21, 30, 42, ?', options: ['54', '56', '57', '60'], answer: 2 },
                // SPATIAL (7 c√¢u)
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh lƒÉng tr·ª• tam gi√°c c√≥ bao nhi√™u ƒë·ªânh?', options: ['4', '5', '6', '8'], answer: 2 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'L·∫≠t g∆∞∆°ng ch·ªØ "E", ta ƒë∆∞·ª£c ch·ªØ g√¨?', options: ['3', '∆é', 'W', 'M'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh 12 m·∫∑t ƒë·ªÅu g·ªçi l√† g√¨?', options: ['B√°t di·ªán', 'Th·∫≠p nh·ªã di·ªán', 'Nh·ªã th·∫≠p di·ªán', 'T·ª© di·ªán'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Khi c·∫Øt h√¨nh n√≥n theo chi·ªÅu ƒë·ª©ng qua ƒë·ªânh, m·∫∑t c·∫Øt c√≥ d·∫°ng:', options: ['H√¨nh tam gi√°c', 'H√¨nh tr√≤n', 'H√¨nh parabol', 'H√¨nh elip'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'Xoay h√¨nh l·ª•c gi√°c ƒë·ªÅu 60¬∞, k·∫øt qu·∫£ l√†:', options: ['Gi·ªëng h√¨nh ban ƒë·∫ßu', 'H√¨nh kh√°c', 'H√¨nh l·ªôn ng∆∞·ª£c', 'H√¨nh nghi√™ng'], answer: 0 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'H√¨nh l·∫≠p ph∆∞∆°ng c√≥ bao nhi√™u ƒë∆∞·ªùng ch√©o kh√¥ng gian?', options: ['2', '4', '6', '8'], answer: 1 },
                { category: 'spatial', categoryName: 'Spatial Reasoning', categoryIcon: 'üìê', question: 'G·∫•p h√¨nh tr√≤n l√†m t∆∞, g√≥c ·ªü t√¢m b·∫±ng:', options: ['45¬∞', '90¬∞', '180¬∞', '120¬∞'], answer: 1 },
                // VERBAL (5 c√¢u)
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'M√πa xu√¢n : Hoa = M√πa thu : ?', options: ['N·∫Øng', 'L√°', 'Tuy·∫øt', 'M∆∞a'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Ki·∫øn tr√∫c s∆∞ : T√≤a nh√† = ƒê·∫ßu b·∫øp : ?', options: ['Nh√† h√†ng', 'M√≥n ƒÉn', 'Dao', 'B·∫øp'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Gi·∫•y : C√¢y = Th·ªßy tinh : ?', options: ['N∆∞·ªõc', 'C√°t', 'ƒê√°', 'Kim lo·∫°i'], answer: 1 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Ng√≥n tay : B√†n tay = C√°nh hoa : ?', options: ['C√†nh', 'L√°', 'B√¥ng hoa', 'R·ªÖ'], answer: 2 },
                { category: 'verbal', categoryName: 'Verbal Analogies', categoryIcon: 'üí¨', question: 'Ng√†y : Tu·∫ßn = Tu·∫ßn : ?', options: ['NƒÉm', 'Th√°ng', 'Gi·ªù', 'Ph√∫t'], answer: 1 }
            ]
        };

        // ============================================
        // STATE & LOGIC
        // ============================================
        let currentQuestion = 0;
        let answers = [];
        let questions = [];
        let selectedSet = '';
        let startTime;
        let timerInterval;
        let userName = '';
        let userEmail = '';
        let department = '';
        const TIME_LIMIT = 25 * 60;

        function startTest() {
            userName = document.getElementById('userName').value.trim();
            userEmail = document.getElementById('userEmail').value.trim();
            department = document.getElementById('department').value;

            if (!userName) { alert('Vui l√≤ng nh·∫≠p h·ªç v√† t√™n!'); return; }
            if (!userEmail) { alert('Vui l√≤ng nh·∫≠p email c√¥ng ty!'); return; }

            // Random ch·ªçn 1 trong 5 b·ªô ƒë·ªÅ
            const setNames = Object.keys(questionSets);
            selectedSet = setNames[Math.floor(Math.random() * setNames.length)];
            questions = questionSets[selectedSet];
            answers = new Array(questions.length).fill(null);

            console.log('B·ªô ƒë·ªÅ ƒë∆∞·ª£c ch·ªçn:', selectedSet);

            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('testScreen').classList.remove('hidden');

            startTime = Date.now();
            startTimer();
            renderQuestion();
        }

        function startTimer() {
            let timeLeft = TIME_LIMIT;
            updateTimerDisplay(timeLeft);
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay(timeLeft);
                if (timeLeft <= 0) { clearInterval(timerInterval); submitTest(); }
            }, 1000);
        }

        function updateTimerDisplay(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            const timerEl = document.getElementById('timer');
            timerEl.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if (seconds <= 60) timerEl.classList.add('timer-warning');
        }

        function renderQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('currentQ').textContent = currentQuestion + 1;
            document.getElementById('progressBar').style.width = `${((currentQuestion + 1) / questions.length) * 100}%`;
            document.getElementById('categoryName').textContent = q.categoryName;
            document.getElementById('categoryBadge').querySelector('span:first-child').textContent = q.categoryIcon;
            document.getElementById('questionText').textContent = q.question;

            const visualArea = document.getElementById('visualArea');
            if (q.matrix) {
                visualArea.innerHTML = renderMatrix(q.matrix);
                visualArea.classList.remove('hidden');
            } else {
                visualArea.innerHTML = '';
                visualArea.classList.add('hidden');
            }

            const optionsArea = document.getElementById('optionsArea');
            const letters = ['A', 'B', 'C', 'D'];
            
            if (q.category === 'pattern' && q.matrix) {
                optionsArea.innerHTML = q.options.map((opt, idx) => `
                    <button class="option-btn ${answers[currentQuestion] === idx ? 'selected' : ''}" onclick="selectAnswer(${idx})">
                        <span class="option-letter">${letters[idx]}</span>
                        <div class="option-visual">${opt}</div>
                    </button>
                `).join('');
            } else {
                optionsArea.innerHTML = q.options.map((opt, idx) => `
                    <button class="option-btn ${answers[currentQuestion] === idx ? 'selected' : ''}" onclick="selectAnswer(${idx})">
                        <span class="option-letter">${letters[idx]}</span>
                        <span class="option-content">${opt}</span>
                    </button>
                `).join('');
            }

            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').innerHTML = currentQuestion === questions.length - 1 ? 'N·ªôp b√†i <span>‚úì</span>' : 'C√¢u ti·∫øp <span>‚Üí</span>';
        }

        function renderMatrix(matrix) {
            return `<div class="matrix matrix-3x3">${matrix.flat().map(cell => `<div class="matrix-cell ${cell === '?' ? 'question-mark' : ''}">${cell}</div>`).join('')}</div>`;
        }

        function selectAnswer(idx) { answers[currentQuestion] = idx; renderQuestion(); }
        function prevQuestion() { if (currentQuestion > 0) { currentQuestion--; renderQuestion(); } }
        function nextQuestion() { if (currentQuestion < questions.length - 1) { currentQuestion++; renderQuestion(); } else { submitTest(); } }

        function submitTest() {
            clearInterval(timerInterval);
            const endTime = Date.now();
            const timeTakenSeconds = Math.floor((endTime - startTime) / 1000);

            let totalCorrect = 0;
            let categoryScores = { pattern: { correct: 0, total: 10 }, number: { correct: 0, total: 8 }, spatial: { correct: 0, total: 7 }, verbal: { correct: 0, total: 5 } };

            questions.forEach((q, idx) => {
                if (answers[idx] === q.answer) {
                    totalCorrect++;
                    categoryScores[q.category].correct++;
                }
            });

            const percentage = (totalCorrect / questions.length) * 100;
            let iq, percentile, classification;

            if (percentage >= 97) { iq = 145; percentile = 99; classification = 'Xu·∫•t s·∫Øc (Thi√™n t√†i)'; }
            else if (percentage >= 93) { iq = 135; percentile = 99; classification = 'R·∫•t cao (Highly Gifted)'; }
            else if (percentage >= 87) { iq = 125; percentile = 95; classification = 'Cao (Gifted)'; }
            else if (percentage >= 80) { iq = 115; percentile = 84; classification = 'Tr√™n trung b√¨nh'; }
            else if (percentage >= 70) { iq = 110; percentile = 75; classification = 'Tr√™n trung b√¨nh'; }
            else if (percentage >= 57) { iq = 105; percentile = 63; classification = 'Trung b√¨nh cao'; }
            else if (percentage >= 43) { iq = 100; percentile = 50; classification = 'Trung b√¨nh'; }
            else if (percentage >= 30) { iq = 95; percentile = 37; classification = 'Trung b√¨nh'; }
            else if (percentage >= 20) { iq = 90; percentile = 25; classification = 'Trung b√¨nh th·∫•p'; }
            else if (percentage >= 13) { iq = 85; percentile = 16; classification = 'D∆∞·ªõi trung b√¨nh'; }
            else { iq = 80; percentile = 9; classification = 'C·∫ßn c·∫£i thi·ªán'; }

            showResults(totalCorrect, iq, percentile, classification, categoryScores, timeTakenSeconds);
        }

        function showResults(correct, iq, percentile, classification, categoryScores, timeTakenSeconds) {
            document.getElementById('testScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');

            document.getElementById('iqScore').textContent = iq;
            document.getElementById('classification').textContent = classification;
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('percentile').textContent = percentile + '%';

            const mins = Math.floor(timeTakenSeconds / 60);
            const secs = timeTakenSeconds % 60;
            document.getElementById('timeTaken').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;

            const descriptions = {
                'Xu·∫•t s·∫Øc (Thi√™n t√†i)': 'NƒÉng l·ª±c nh·∫≠n th·ª©c v∆∞·ª£t tr·ªôi, thu·ªôc top 1% d√¢n s·ªë.',
                'R·∫•t cao (Highly Gifted)': 'NƒÉng l·ª±c nh·∫≠n th·ª©c r·∫•t cao, h·ªçc h·ªèi nhanh.',
                'Cao (Gifted)': 'NƒÉng l·ª±c t∆∞ duy logic v√† gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ t·ªët.',
                'Tr√™n trung b√¨nh': 'Kh·∫£ nƒÉng nh·∫≠n th·ª©c t·ªët, x·ª≠ l√Ω c√¥ng vi·ªác ph·ª©c t·∫°p.',
                'Trung b√¨nh cao': 'NƒÉng l·ª±c nh·∫≠n th·ª©c kh√°, ƒë√°p ·ª©ng t·ªët y√™u c·∫ßu.',
                'Trung b√¨nh': 'NƒÉng l·ª±c nh·∫≠n th·ª©c ·ªü m·ª©c trung b√¨nh.',
                'Trung b√¨nh th·∫•p': 'C√≥ th·ªÉ c·∫ßn h·ªó tr·ª£ th√™m trong nhi·ªám v·ª• ph·ª©c t·∫°p.',
                'D∆∞·ªõi trung b√¨nh': 'N√™n t·∫≠p trung v√†o c√¥ng vi·ªác c√≥ quy tr√¨nh r√µ r√†ng.',
                'C·∫ßn c·∫£i thi·ªán': 'Khuy·∫øn ngh·ªã ƒë√†o t·∫°o th√™m ƒë·ªÉ n√¢ng cao nƒÉng l·ª±c.'
            };
            document.getElementById('resultDesc').textContent = descriptions[classification] || '';

            setTimeout(() => {
                document.getElementById('patternBar').style.width = (categoryScores.pattern.correct / categoryScores.pattern.total * 100) + '%';
                document.getElementById('numberBar').style.width = (categoryScores.number.correct / categoryScores.number.total * 100) + '%';
                document.getElementById('spatialBar').style.width = (categoryScores.spatial.correct / categoryScores.spatial.total * 100) + '%';
                document.getElementById('verbalBar').style.width = (categoryScores.verbal.correct / categoryScores.verbal.total * 100) + '%';
                document.getElementById('patternScore').textContent = `${categoryScores.pattern.correct}/${categoryScores.pattern.total}`;
                document.getElementById('numberScore').textContent = `${categoryScores.number.correct}/${categoryScores.number.total}`;
                document.getElementById('spatialScore').textContent = `${categoryScores.spatial.correct}/${categoryScores.spatial.total}`;
                document.getElementById('verbalScore').textContent = `${categoryScores.verbal.correct}/${categoryScores.verbal.total}`;
            }, 300);

            window.testResult = {
                name: userName,
                email: userEmail,
                department: department,
                testSet: selectedSet.replace('set', 'B·ªô ƒë·ªÅ '),
                date: new Date().toLocaleDateString('vi-VN'),
                datetime: new Date().toISOString(),
                iq: iq,
                percentile: percentile,
                classification: classification,
                correct: correct,
                total: questions.length,
                timeTaken: `${mins}:${secs.toString().padStart(2, '0')}`,
                categories: categoryScores
            };

            saveToGoogleSheets(window.testResult);
        }

        async function saveToGoogleSheets(result) {
            const statusEl = document.getElementById('saveStatus');
            
            if (CONFIG.GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL') {
                statusEl.className = 'save-status error';
                statusEl.innerHTML = '‚ö†Ô∏è Ch∆∞a c·∫•u h√¨nh Google Sheets.';
                return;
            }

            try {
                await fetch(CONFIG.GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        timestamp: result.datetime,
                        name: result.name,
                        email: result.email,
                        department: result.department,
                        testSet: result.testSet,
                        iq: result.iq,
                        percentile: result.percentile,
                        classification: result.classification,
                        correctAnswers: result.correct,
                        totalQuestions: result.total,
                        timeTaken: result.timeTaken,
                        patternScore: `${result.categories.pattern.correct}/${result.categories.pattern.total}`,
                        numberScore: `${result.categories.number.correct}/${result.categories.number.total}`,
                        spatialScore: `${result.categories.spatial.correct}/${result.categories.spatial.total}`,
                        verbalScore: `${result.categories.verbal.correct}/${result.categories.verbal.total}`
                    })
                });
                statusEl.className = 'save-status';
                statusEl.innerHTML = '‚úÖ K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!';
            } catch (error) {
                statusEl.className = 'save-status error';
                statusEl.innerHTML = '‚ùå L·ªói khi l∆∞u. Vui l√≤ng t·∫£i file v·ªÅ.';
            }
        }

        function downloadResult() {
            const r = window.testResult;
            const text = `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        K·∫æT QU·∫¢ B√ÄI TEST IQ - ${r.testSet.toUpperCase()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

H·ªç v√† t√™n:     ${r.name}
Email:         ${r.email}
Ph√≤ng ban:     ${r.department || 'Ch∆∞a x√°c ƒë·ªãnh'}
Ng√†y l√†m b√†i:  ${r.date}
B·ªô ƒë·ªÅ:         ${r.testSet}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                 K·∫æT QU·∫¢ T·ªîNG QUAN
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìä ƒêI·ªÇM IQ:        ${r.iq}
üìà PERCENTILE:     ${r.percentile}%
üéØ PH√ÇN LO·∫†I:      ${r.classification}
‚úÖ S·ªê C√ÇU ƒê√öNG:    ${r.correct}/${r.total}
‚è±Ô∏è TH·ªúI GIAN:      ${r.timeTaken}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
              CHI TI·∫æT THEO DANH M·ª§C
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üî∑ Pattern Recognition:  ${r.categories.pattern.correct}/${r.categories.pattern.total}
üî¢ Number Sequences:     ${r.categories.number.correct}/${r.categories.number.total}
üìê Spatial Reasoning:    ${r.categories.spatial.correct}/${r.categories.spatial.total}
üí¨ Verbal Analogies:     ${r.categories.verbal.correct}/${r.categories.verbal.total}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            `.trim();

            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `KetQua_IQ_${r.name.replace(/\s+/g, '_')}_${r.date.replace(/\//g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function restartTest() {
            currentQuestion = 0;
            answers = [];
            questions = [];
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            document.getElementById('userName').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('department').value = '';
            document.getElementById('timer').classList.remove('timer-warning');
        }
    </script>
</body>
</html>
